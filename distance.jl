# Calcul des distances entre deux stations
# Script issu de https://www.movable-type.co.uk/scripts/latlong.html ; traduit et adapté depuis JavaScript

#Données
coord = [47.23241 -1.516079;    #Landreau
        47.240043 -1.512399;    #Cousteau
        47.245229 -1.509943;    #Perray
        47.252978 -1.505651;    #Garde
        47.262416 -1.500158;    #Tertre
        # 47.274675 -1.493163;    #Giraudière
        47.276644 -1.491907;    #Lycée
        # 47.282933 -1.486125;    #Villages
        47.295268 -1.485513;   #Carquefou Gare
        47.297251 -1.492025;   #Carquefou Centre
        47.299027 -1.499150]   #Fleuriaye
        # 47.304760 -1.502969]    #Nord

#Calcul
function distance(lat1, lon1, lat2, lon2)

        R = 6371e3; # metres
        φ1 = lat1 * π/180; # φ, λ in radians
        φ2 = lat2 * π/180;
        Δφ = (lat2-lat1) * π/180;
        Δλ = (lon2-lon1) * π/180;

        a = sin(Δφ/2) * sin(Δφ/2) +
                  cos(φ1) * cos(φ2) *
                  sin(Δλ/2) * sin(Δλ/2);
        c = 2 * atan(sqrt(a), sqrt(1-a));

        d = R * c; # in metres

        return d
end

function OD_distance()
        dist = []

        for i in 1:8
                d_curr = distance(coord[i,1], coord[i,2], coord[i+1,1], coord[i+1,2])
                push!(dist, d_curr)
                print("De ",i, " à ", i+1, " : ");println(d_curr)
        end

        return dist
end

function calcultemps()

        d =  [0 893.068 1498.796 2419.334 3547.7 5247.861 7374.171 7912.492 ;
        893.068 0 605.728 1526.266 2654.632 4354.793 6481.103 7019.424 ;
        1498.796 605.728 0 920.538 2048.904 3749.065 5875.375 6413.696 ;
        2419.334 1526.266 920.538 0 1128.366 2828.527 4954.837 5493.158  ;
        3547.7 2654.632 2048.904 1128.366 0 1700.161 3826.471 4364.792;
        5247.861 4354.793 3749.065 2828.527 1700.161 0 2126.31 2664.631;
        7374.171 6481.103 5875.375 4954.837 3826.471 2126.31 0 538.321 ;
        7912.492 7019.424 6413.696 5493.158 4364.792 2664.631 538.321 0]
        v = 5.55556

        t = d/v

        print(t)
end


function calculIntervalle()

        t = [0.0 160.7521113983109 269.78306417354867 435.4797716161827 638.5854891316087 944.6142243086206 1327.3497181202256 1424.2474206020636;
        160.7521113983109 0.0 109.03095277523778 274.72766021787186 477.8333777332978 783.8621129103096 1166.5976067219146 1263.4953092037526;
        269.78306417354867 109.03095277523778 0.0 165.69670744263405 368.80242495806004 674.831160135072 1057.566653946677 1154.464356428515;
        435.4797716161827 274.72766021787186 165.69670744263405 0.0 203.105717515426 509.1344526924379 891.8699465040429 988.7676489858809;
        638.5854891316087 477.8333777332978 368.80242495806004 203.105717515426 0.0 306.02873517701187 688.7642289886169 785.6619314704549;
        944.6142243086206 783.8621129103096 674.831160135072 509.1344526924379 306.02873517701187 0.0 382.73549381160495 479.63319629344295;
        1327.3497181202256 1166.5976067219146 1057.566653946677 891.8699465040429 688.7642289886169 382.73549381160495 0.0 96.89770248183802;
        1424.2474206020636 1263.4953092037526 1154.464356428515 988.7676489858809 785.6619314704549 479.63319629344295 96.89770248183802 0.0]

        # interv_inf = t - 0.05*t
        # println("intervalle inf : ", interv_inf)

        interv_sup =  t + 0.05*t
        println("intervalle inf : ", interv_sup)

end
